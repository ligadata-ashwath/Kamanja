<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Adding, updating, and removing PMML Models &#8212; Kamanja 1.6.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="adding-updating-and-removing-pmml-models">
<span id="pmml-guide-add-remove"></span><h1>Adding, updating, and removing PMML Models<a class="headerlink" href="#adding-updating-and-removing-pmml-models" title="Permalink to this headline">¶</a></h1>
<p>PMML models vary from the standard Kamanja model ingestion mechanism
for Scala, Java, and kPMML models.
The namespace.name model, model version,
and namespace.name message must be supplied on the command-line.
Here are a few Kamanja script examples to illustrate the basic commands.
The value of the KAMANJA_HOME variable in the examples
is the Kamanja install location.
The value is the working directory where the model to be ingested is located.</p>
<div class="section" id="adding-a-pmml-model">
<h2>Adding a PMML Model<a class="headerlink" href="#adding-a-pmml-model" title="Permalink to this headline">¶</a></h2>
<p>In this example, an add model command is invoked.
The command is followed by several name/value pairs.
Its version must also be supplied.
When treated as a Long integer,
its value must be greater than any other version for models with this name.
The PMML model text is supplied in the pmml value,
namely $KAMANJA_SRCDIR/Pmml/JpmmlAdapter/src/main/resources/metadata/model/Rattle/DecisionTreeAuto.pmml.
Note that the leading 0s are not required,
but used here to illustrate the maximum size that the Long version can take
(when ‘.’ is eliminated).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$KAMANJA_HOME/bin/kamanja
$KAMANJA_HOME/config/MetadataAPIConfig.properties
add model pmml &lt;SomePath&gt;/DecisionTreeAuto.pmml
MODELNAME com.auto.pmml.DecisionTreeAuto
MODELVERSION 000000.000001.000001
MESSAGENAME System.AutoMsg TENANTID tenant1
</pre></div>
</div>
<p>Note: An important detail is the structure
of the value of the MODELNAME portion of the command.
The detail is that this MUST have both a namespace and a model name part,
separated by a period, as in abc.xyz.
In this example, abc is the namespace and xyz is the model name.
These should be meaningful text,
as they will identify the model in any list of active models;
although they can be ANY text,
although it would be wise NOT to include spaces.</p>
<p>Note: Kamanja has basic multi-tenancy (new in v1.4).
Therefore, every time a container, message, or model is added or updated,
specify the tenant ID.
Multi-tenancy allows deployment of more than one use case to a cluster.
Multiple use cases can exist on the same cluster.</p>
</div>
<div class="section" id="updating-a-pmml-model">
<h2>Updating a PMML Model<a class="headerlink" href="#updating-a-pmml-model" title="Permalink to this headline">¶</a></h2>
<p>The update model command updates the model added in the prior example.
It deletes the existing latest version of the model
and then effectively adds the new version supplied on the command-line.
Notice the newVersion value abides by the rule
that any new version to be added when other versions of the same model exist
must be greater than the latest version available in the metadata.
Presumably the new source file is different from that it is replacing.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$KAMANJA_HOME/config/MetadataAPIConfig.properties
update model pmml &lt;SomePath&gt;/DecisionTreeAuto.pmml
MODELNAME com.auto.pmml.DecisionTreeAuto
MODELVERSION 0.1.2 TENANTID tenant1
</pre></div>
</div>
<p>Note that, with the current implementation,
it is not possible to replace any version of a given model.
Only the latest version can be replaced.</p>
</div>
<div class="section" id="removing-a-pmml-model">
<h2>Removing a PMML Model<a class="headerlink" href="#removing-a-pmml-model" title="Permalink to this headline">¶</a></h2>
<p>The standard remove model command used for the other model types
is also used for PMML. Note the form of the version.
A segmented version is not used. A Long constant is used instead.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$KAMANJA_HOME/bin/kamanja
$KAMANJA_HOME/config/MetadataAPIConfig.properties
remove model com.auto.pmml.DecisionTreeAuto.000000000001000002
</pre></div>
</div>
</div>
<div class="section" id="a-note-on-input-message-configuration">
<h2>A Note on Input Message Configuration<a class="headerlink" href="#a-note-on-input-message-configuration" title="Permalink to this headline">¶</a></h2>
<p>Kamanja is a cluster-based platform.
Whereever possible and desirable,
work is broken up and distributed
to one (or more) of the nodes in the cluster for execution,
permitting Kamanja to increase throughput
via parallelism endemic to the cluster architecture.
What this means for the PMML model author
is that the messages developed for the datasets
(that is, the input DataField values) need to have a partition key.
This key may not necessarily be needed by the model computation itself,
but one is needed to cause the engine planner
to distribute the work about the cluster
to balance the work load/achieve parallelism.</p>
<p>For this reason, it is suggested that an additional field be added
to the dataset (if appropriate)
that contains a unique ordinal value
relative to the others being received in the same relative time frame.
This value could be the timestamp, an integer counter.
Obviously, if there is some field being used in the model
that would serve this purpose, by all means use that.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Adding, updating, and removing PMML Models</a><ul>
<li><a class="reference internal" href="#adding-a-pmml-model">Adding a PMML Model</a></li>
<li><a class="reference internal" href="#updating-a-pmml-model">Updating a PMML Model</a></li>
<li><a class="reference internal" href="#removing-a-pmml-model">Removing a PMML Model</a></li>
<li><a class="reference internal" href="#a-note-on-input-message-configuration">A Note on Input Message Configuration</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pmml/add-remove.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, LigaData Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../_sources/pmml/add-remove.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>